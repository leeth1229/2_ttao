import pandas as pd
import streamlit as st
from PIL import Image
import streamlit_antd_components as sac
import streamlit_antd_components as sac
import numpy as np
import sys
import openpyxl
from openpyxl import load_workbook
import fitz  # PyMuPDF
import re
import os
import pickle
import tempfile
import dataiku
import math
import io
from io import BytesIO
from datetime import datetime, timedelta

from function_search import all_add_data
from function_search import add_to_cart
from function_search import add_rows_to_excel
from function_search import cart_foramt
from function_search import boom_format
from function_search import fst_line
from function_search import plant_load_data
from function_search import default_data_df
from function_search import edited_cart_df_materail

pd.options.display.float_format = '{:.0f}'.format

# ì´ˆê¸°í™”
if 'Cart_dataframe' not in st.session_state:
    st.session_state.Cart_dataframe = pd.DataFrame()

@st.cache_data
def get_folder_paths():
    FOLDER = dataiku.Folder("ezuSeiHz")
    list_files = []
    for list_file in FOLDER.list_paths_in_partition():
        if list_file.endswith(".xlsx"):
            list_files.append(list_file)

    folder_paths = []
    for file_path in list_files:
        folder_path = os.path.dirname(file_path)
        folder_paths.append(folder_path)

    return folder_paths, list_files, FOLDER
folder_paths, list_files, FOLDER = get_folder_paths()

@st.cache_data()
def convert_dir_to_tree(folder_paths):
    tree_items = []  # This will store the converted tree items.
    group_items = {}  # This will store the group items.

    for file_path in folder_paths:
        # Split the path into parts
        parts = file_path.strip("/").split("/")
        group_name = parts[0]  # The first part is always the group name

        # Ensure group item exists
        group_item = group_items.get(group_name)
        if group_item is None:
            group_item = sac.TreeItem(group_name, disabled=True, children=[])
            tree_items.append(group_item)
            group_items[group_name] = group_item

        # Iterate through the rest of the parts to build the tree structure
        current_item = group_item
        for folder_name in parts[1:]:
            # Check if the folder item already exists under the current item
            folder_item = None
            for child_item in current_item.children:
                if child_item.label == folder_name:
                    folder_item = child_item
                    break

            # If the folder item doesn't exist, create and append it
            if folder_item is None:
                folder_item = sac.TreeItem(folder_name, children=[])
                current_item.children.append(folder_item)
            
            # Move the current item pointer to the new or found folder item
            current_item = folder_item
    return tree_items
tree_items = convert_dir_to_tree(folder_paths)

def search_tree_factory(tree_items, query):
    # Filter top-level items that contain the query in their label
    filtered_items = []
    for item in tree_items:
        if query.lower() in item.label.lower():  # Case-insensitive search
            filtered_items.append(item)
    return filtered_items

def search_tree_items(tree_items, query):
    # ê²€ìƒ‰ì–´ê°€ í¬í•¨ëœ í•­ëª©ë§Œ í•„í„°ë§
    filtered_items = []
    for item in tree_items:
        if query.lower() in item.label.lower():  # ëŒ€ì†Œë¬¸ì êµ¬ë¶„ ì—†ì´ ê²€ìƒ‰
            filtered_items.append(item)
        else:
            # ìì‹ í•­ëª© ì¤‘ì—ì„œ ê²€ìƒ‰
            child_matches = search_tree_items(item.children, query)
            if child_matches:
                new_item = sac.TreeItem(item.label, disabled=True, children=child_matches)
                filtered_items.append(new_item)
    return filtered_items

@st.cache_data()
def convert_outlines_to_tree(outlines, parent_level=1):
    tree_items = []  # This will store the converted tree items.
    while outlines:
        # Extract the first outline item
        level, title, _ = outlines[0][:3]
        
        if level < parent_level:
            # If the current level is lower than the parent's, break from the loop
            break
        elif level > parent_level:
            # If the current level is deeper, recursively process the nested items
            # Assuming the last item in the list is the parent
            if tree_items:
                tree_items[-1].children = convert_outlines_to_tree(outlines, level)
        else:
            # Remove the processed item from outlines
            outlines.pop(0)
            # Create a new TreeItem and add it to the list
            item = sac.TreeItem(title, children=[])
            tree_items.append(item)

    return tree_items

############################################################################################################################################################################################################################

# ì‚¬ì´ë“œë°”
with st.sidebar:

    if "plant" not in st.session_state:
        st.session_state.plant = "All"
        st.session_state.email = "biliy@lgchem.com"
        now = datetime.now()
        future_date = now + timedelta(days=2)
        future_date = future_date.strftime('%Y%m%d')
        st.session_state.future_date = future_date
        st.session_state.now = now
        st.session_state.save_point = "9600"

    st.write(f"Plant: {st.session_state.plant}")
    st.write(f"Email: {st.session_state.email}")
    st.write(f"ì €ì¥ìœ„ì¹˜: {st.session_state.save_point}")
    st.write(f"Today: {st.session_state.now.strftime('%Y.%m.%d')}")

    sac.divider(label='Search Tag No', align='center', color='gray')

    if st.session_state.plant != "All":
        tree_items = search_tree_factory(tree_items, st.session_state.plant)
    
    search_query = st.text_input("Search Tag No.", placeholder='Tag No. ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš” "/" ë¥¼ í†µí•´ êµ¬ë¶„ ê°€ëŠ¥')

    trees_swich = sac.switch(label='Check Active', align='end', size='md')

    if trees_swich is not True:
        if search_query == "":
            Item_ = sac.tree(
                items = tree_items,
                label='Tag No.',
                color='#4682b4',
                # size='xm',
                index=0,
                width=400, 
                height=300,
                key='tree',
                show_line=False,
                open_all=False,
                checkbox=False,
                return_index=False,
                checkbox_strict = False
                )

        if search_query != "":
            if "/" in search_query:
                search_query_lists = search_query.split("/")
                for i in range(len(search_query_lists)):
                    tree_items = search_tree_items(tree_items, search_query_lists[i])

            else:
                tree_items = search_tree_items(tree_items, search_query)
            
            Item_ = sac.tree(
                items = tree_items,
                label='Tag No.',
                color='#4682b4',
                # size='xm',
                index=0,
                width=400, 
                height=300,
                show_line=False,
                open_all=True,
                checkbox=False,
                return_index=False,
                checkbox_strict = False
                )

    else:
        if search_query == "":
            Item_ = sac.tree(
                items = tree_items,
                label='Tag No.',
                color='#4682b4',
                # size='xm',
                # index=0,
                width=400, 
                height=300,
                show_line=False,
                open_all=False,
                checkbox=True,
                return_index=False,
                checkbox_strict = False
                )

        if search_query != "":
            if "/" in search_query:
                search_query_lists = search_query.split("/")
                for i in range(len(search_query_lists)):
                    tree_items = search_tree_items(tree_items, search_query_lists[i])

            else:
                tree_items = search_tree_items(tree_items, search_query)
            
            Item_ = sac.tree(
                items = tree_items,
                label='Tag No.',
                color='#4682b4',
                # size='xm',
                # index=0,
                width=400, 
                height=300,
                show_line=False,
                open_all=True,
                checkbox=True,
                return_index=False,
                checkbox_strict = False
                )

        if st.button("All Add to cart"):
            for item in Item_:
                for k in range(len(folder_paths)):
                    if item == folder_paths[k].split("/")[-1]:
                        concat_list_path = f"{folder_paths[k]}/{item}.xlsx"
                        df_concat = all_add_data(concat_list_path)
                        df_cart_foramt = cart_foramt()
                        df_materail_cart = pd.concat([df_cart_foramt, df_concat]).reset_index(drop=True)
                        df_materail_cart = df_materail_cart
                        st.session_state.Cart_dataframe = pd.concat([st.session_state.Cart_dataframe, df_materail_cart]).reset_index(drop=True)
            st.toast('success!', icon="âœ…")

    sac.divider(label='end', align='center', color='gray')

    if Item_ and isinstance(Item_, str) != True: # íƒ€ì´í‹€ì´ ë¦¬ìŠ¤íŠ¸ë¡œ í‘œê¸°ë˜ë©´
        st.session_state.Item_ = Item_[0]
    else: 
        st.session_state.Item_ = Item_ # íƒ€ì´í‹€ì´ ë¬¸ìì—´ì´ë©´

    # í´ë” íŒ¨ìŠ¤
    if st.session_state.Item_ is not None and not isinstance(st.session_state.Item_, list):
        Item_ = st.session_state.Item_.split(".")[0]
    else:
        st.write("ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.")
        sys.exit()
    
    for index, path in enumerate(folder_paths):
        if Item_ in path:
            tag_index = index
            break

    df_boom_list_path = f"{list_files[tag_index]}"

        
############################################################################################################################################################################################################################

# íƒ­ ìƒì„±
tab1, tab2, tab3, tab4 = st.tabs(["Special Code","Ref.PDF","Cart list","Help"])



with tab1:

    st.subheader("_Special Code list_")
    st.write(df_boom_list_path)

    with FOLDER.get_download_stream(df_boom_list_path) as f:
        df_boom_list = pd.read_excel(f.read(), engine='openpyxl')

    if Item_ is not None:
        if len(df_boom_list.index) == 0:
            df_boom_list = pd.concat([boom_format(), default_data_df(df_boom_list_path)]).reset_index(drop=True)
        
        df_boom_list = pd.concat([fst_line(), df_boom_list]).reset_index(drop=True)
        df_boom_list = df_boom_list.astype(str)

        df_boom_list["Check"] = False
        cols = list(df_boom_list.columns)
        cols.insert(0, cols.pop(cols.index("Check")))
        df_boom_list = df_boom_list[cols]

        edited_df_boom_list = st.data_editor(df_boom_list[1:],
                                            key='edited_key1',
                                            use_container_width=True,
                                            column_config={
                                                "Check" : st.column_config.CheckboxColumn(
                                                    width = 0.001,
                                                    default = "False"),
                                                "ìš”ì²­êµ¬ë¶„" : st.column_config.NumberColumn(
                                                    format = "%d",
                                                    width = 0.01,
                                                    help = "êµ¬ë§¤ìì¬ = 1 , ì˜ˆì•½ìì¬ = 2"),
                                                "ìì¬ì½”ë“œ" : st.column_config.NumberColumn(
                                                    format = "%d",
                                                    help = "ERP ì½”ë“œ",
                                                    width = 0.01),
                                                "ìš”ì²­ìˆ˜ëŸ‰" : st.column_config.NumberColumn(
                                                    format = "%d",
                                                    width = 0.01),
                                                "Description" : st.column_config.Column(
                                                    width = 1200),
                                                "ì„¤ë¹„íƒœê·¸ë²ˆí˜¸" : st.column_config.Column(
                                                    width = 0.01),
                                                "ì„¤ë¹„ID" : st.column_config.NumberColumn(
                                                    format = "%d",
                                                    width = 0.01),
                                                "model_no" : st.column_config.Column(
                                                    width = 0.01,
                                                    help = "ì„¤ë¹„ Model No. ì…ë ¥"),
                                                "maker" : st.column_config.Column(
                                                    "Sub_Vendor",
                                                    width = 0.01,
                                                    help = "ìì¬ ë‚©í’ˆ ë°´ë”ë¥¼ ì…ë ¥í•´ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤."),
                                                "dwg_no" : st.column_config.Column(
                                                    width = 0.01,
                                                    help = "ë„ë©´ No. ì…ë ¥"),
                                                "item_no" : st.column_config.Column(
                                                    width = 0.01,
                                                    help = "ë„ë©´ ë‚´, ìì¬ë²ˆí˜¸. ì…ë ¥"),
                                                "part_no" : st.column_config.Column(
                                                    width = 0.01,
                                                    help = "ìì¬ íŒŒíŠ¸ No. ì…ë ¥")
                                                },
                                            num_rows="dynamic", 
                                            )

    # ë°ì´í„° ì €ì¥ ë²„íŠ¼
    if st.button('Save'):
        try:
            buf = io.BytesIO()
            edited_df_boom_list.to_excel(buf, index=False)
            FOLDER.upload_stream(df_boom_list_path, buf.getvalue())
            buf.close()
            st.toast('success!', icon="âœ…")
        except Exception as e:
            st.error(f'ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}')     

    # ì´ˆê¸°í™”
    if 'Cart_dataframe' not in st.session_state:
        st.session_state.Cart_dataframe = pd.DataFrame()

    # ì¹´íŠ¸ ì¶”ê°€ ë²„íŠ¼ ë…¸ë§
    if st.button('Add to cart'):
        df_materail_cart = add_to_cart(edited_df_boom_list)
        df_cart_foramt = cart_foramt()
        df_materail_cart = pd.concat([df_cart_foramt, df_materail_cart]).reset_index(drop=True)
        st.session_state.Cart_dataframe = pd.concat([st.session_state.Cart_dataframe, df_materail_cart]).reset_index(drop=True)
        st.toast('success!', icon="âœ…")

    # Download Excel ë²„íŠ¼
    with FOLDER.get_download_stream(df_boom_list_path) as f:
        data = f.read()
        st.download_button(label = 'Download boom list :white_check_mark:', data = data, file_name = df_boom_list_path, mime = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')


with tab2:
    # ë“œë¡œì‰
    st.subheader("_Drawing Viewing_")

    # PDF ì…€ë ‰ì…˜
    item_folder = df_boom_list_path.rsplit('/', 1)[0]  
    
    with tempfile.TemporaryDirectory() as temp_dir:
        temp_file_list = []
        for path in FOLDER.list_paths_in_partition():
            if path.startswith(item_folder) and path.endswith(".pdf"):
                with FOLDER.get_download_stream(path) as f:
                    with open(os.path.join(temp_dir, path.split("/")[-1]), "wb") as temp_file:
                        temp_file.write(f.read())
                        temp_file_list.append(temp_file)
                        
        pdf_list = os.listdir(temp_dir)

        if len(pdf_list) != 0:
            pdf_name_index = pdf_list.index(st.selectbox("ğŸ“‘ PDF ì„ íƒ", pdf_list))

            st.write(os.path.join(item_folder, pdf_list[pdf_name_index]))
            # Download Excel ë²„íŠ¼
            with FOLDER.get_download_stream(os.path.join(item_folder, pdf_list[pdf_name_index])) as f:
                data = f.read()
                st.download_button(label = 'Download_', data = data, file_name = pdf_list[pdf_name_index], mime = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')

            temp_file = temp_file_list[pdf_name_index]
            doc = fitz.open(temp_file)

            # ì•„ì›ƒë¼ì¸(ëª©ì°¨) ì¶”ì¶œ
            outlines = doc.get_toc(simple=False)

            unique_key = []
            for outline in outlines:
                _ , title, page = outline[:3]
                unique_key.append({title: page})

            # Convert your document outlines to a tree structure
            tree_items_outlines = convert_outlines_to_tree(outlines)

    if len(pdf_list) != 0:
        page_number = 0
        if "page_number" not in st.session_state:
            st.session_state.page_number = 0

        page_number_new = 0
        if 'page_number_new' not in st.session_state:
            st.session_state.page_number_new = 0

        rotation = 0
        if 'rotation' not in st.session_state:
            st.session_state.rotation = 0

        
        col3, col4 = st.columns((1, 4))
        with col3:# í˜ì´ì§€ ì´ë™ ë²„íŠ¼
            # ì§€ì • í˜ì´ì§€ë¡œ ì´ë™í•˜ëŠ” í…ìŠ¤íŠ¸ ì…ë ¥
            st.write("## Go to Page")
            page_input = st.text_input("Enter page number:",placeholder = "clearing for page-move", value="", key="input")
            if page_input:
                try:
                    page_ = int(page_input) - 1 # ì‚¬ìš©ì ì…ë ¥ì„ í˜ì´ì§€ ë²ˆí˜¸ë¡œ ë³€í™˜ (0 ê¸°ë°˜ ì¸ë±ì‹±)
                    if 0 <= page_number < len(doc):
                        st.session_state.page_number = page_
                    else:
                        st.error("Page number out of range.")
                except ValueError:
                    st.error("Please enter a valid page number.")
            # ì•„ì›ƒë¼ì¸ ë„¤ë¹„ê²Œì´ì…˜
            st.write("## Navigation")
            
            # Use the tree_items in your sac.tree
            title = sac.tree(
                items=tree_items_outlines,
                label='PDF Outlines',
                open_all=True,
                size='md',
                checkbox_strict=True
            )
            
            # í˜„ì¬ í˜ì´ì§€ íƒ€ì´í‹€ í‘œê¸°
            if title and isinstance(title, str) == False: # íƒ€ì´í‹€ì´ ë¦¬ìŠ¤íŠ¸ë¡œ í‘œê¸°ë˜ë©´
                st.session_state.title = title[0]
                st.write(st.session_state.title)
            else: 
                st.session_state.title = title # íƒ€ì´í‹€ì´ ë¬¸ìì—´ì´ë©´
                st.write(st.session_state.title)

            # Initialize a variable to hold the page number
            if page_input == "":
                # Search for the title in the list of dictionaries
                for unique_dict in unique_key:
                    if st.session_state.title in unique_dict:
                        page_number_new = unique_dict[st.session_state.title]
                        break  # Exit the loop once the title is found
                if st.session_state.page_number_new != page_number_new: #ê°’ì´ ë³€ê²½ ë˜ë©´ 
                    st.session_state.page_number_new = page_number_new
                    st.session_state.page_number = st.session_state.page_number_new - 1

        with col4:
            col1, col2 = st.columns(2)
            with col1:# í˜ì´ì§€ ì´ë™ ë²„íŠ¼
                if st.button('Previous Page'):
                    page_number_ = st.session_state.page_number - 1
                    st.session_state.page_number = max(0, page_number_)
                # í˜ì´ì§€ íšŒì „ ë²„íŠ¼
                if st.button("Rotate -90Â° :arrow_right_hook:"):
                    st.session_state.rotation -= 90
                
            with col2: # í˜ì´ì§€ ì´ë™ ë²„íŠ¼
                if st.button('Next Page'):
                    page_number_ = st.session_state.page_number + 1
                    st.session_state.page_number = min(len(doc) - 1, page_number_)
                # í˜ì´ì§€ íšŒì „ ë²„íŠ¼
                if st.button("Rotate 90Â° :leftwards_arrow_with_hook:"):
                    st.session_state.rotation += 90

            # í˜„ì¬ í˜ì´ì§€ ë¡œë“œ ë° í‘œì‹œ
            if st.session_state.page_number is not None:
                current_page_number = st.session_state.page_number
                pages_to_show = [current_page_number]
                if current_page_number < len(doc) - 1:  # ë‹¤ìŒ í˜ì´ì§€ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° ì¶”ê°€
                    pages_to_show.append(current_page_number + 1)

            # ì´ë¯¸ì§€ ë³€í™˜ì— ì‚¬ìš©í•  ìŠ¤ì¼€ì¼ë§ ë§¤íŠ¸ë¦­ìŠ¤ ì •ì˜ (ë„ˆë¹„ í™•ì¥)
            scaling_matrix = fitz.Matrix(4.0, 4.0)  # ë„ˆë¹„ì™€ ë†’ì´ë¥¼ 2ë°°ë¡œ í™•ì¥
            rotation_matrix = scaling_matrix.prerotate(st.session_state.rotation)

            # Display current page
            if st.session_state.page_number < doc.page_count:
                page = doc.load_page(st.session_state.page_number)
                pix = page.get_pixmap(matrix=rotation_matrix)
                img = Image.frombytes("RGB", [pix.width, pix.height], pix.samples)
                st.image(img, caption=f"Page {st.session_state.page_number + 1}" , use_column_width=True)
            else:
                st.session_state.page_number = 0
                page = doc.load_page(st.session_state.page_number)
                pix = page.get_pixmap(matrix=rotation_matrix)
                img = Image.frombytes("RGB", [pix.width, pix.height], pix.samples)
                st.image(img, caption=f"Page {st.session_state.page_number + 1}" , use_column_width=True)
    else:
        st.write("ì €ì¥ë˜ì–´ìˆëŠ” ë„ë©´ì´ ì—†ìŠµë‹ˆë‹¤.")

    #PDF ì—…ë¡œë“œ 
    st.markdown("### ğŸ“ pdf Uplaod")
    st.write("â¡ï¸ file Path : ",item_folder,"/ 'file_name'.pdf")
    uploaded_files = st.file_uploader("PDF Upload", accept_multiple_files=True)

    if st.button('ğŸ’¾ Upload'):
        for uploaded_file in uploaded_files:
            if uploaded_file.name.endswith('.pdf'):
                PDF_file_data = uploaded_file.getvalue()
                with BytesIO(PDF_file_data) as f:
                    FOLDER.upload_stream(f'{item_folder}/{uploaded_file.name}', f)
            else:
                st.warning(f"{uploaded_file.name} is not a valid file type. Only PDF files are allowed.")
                continue
        st.sidebar.success(f"Created {item_folder}")

with tab3:
    # ì¥ë°”êµ¬ë‹ˆ íƒ€ì´í‹€ ì¶”ê°€
    st.subheader("_Cart List_ ğŸ›’")

    # Reset Cart ë²„íŠ¼
    if st.button('Reset Cart'):
        df_materail_cart = pd.DataFrame()
        st.session_state.Cart_dataframe = pd.DataFrame()
        st.toast('success!', icon="âœ…")

    # ì¥ë°”êµ¬ë‹ˆ í”„ë ˆì„
    edited_cart_df_materail = edited_cart_df_materail(st.session_state.Cart_dataframe)

    # ì¹´íŠ¸ Save_ ë²„íŠ¼
    if st.button('Save_'):
        st.session_state.Cart_dataframe = edited_cart_df_materail
        st.toast('success!', icon="âœ…")

    # Download Excel ë²„íŠ¼
    with open("cart_list.xlsx", 'rb') as my_file:
        st.session_state.Cart_dataframe.to_excel('cart_list.xlsx', index=False)
        add_rows_to_excel('cart_list.xlsx')
        st.download_button(label = 'Download Cart :white_check_mark:', data = my_file, file_name = 'cart_list.xlsx', mime = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')

    # ì¹´íŠ¸ Save_ ë²„íŠ¼
    if st.button('lamp(m) ë¶ˆì¶œì„œ'):
        st.write("ê¸°ëŠ¥ê°œë°œì¤‘")

with tab4:
    st.markdown(
            """
            ### _UPLOAD_ :
            *Lamp (M) â–¶ï¸ ì‘ì—…ê³„íšìˆ˜ë¦½ â–¶ï¸ '+ìì¬ì¶”ê°€' â–¶ï¸ 'ì—…ë¡œë“œ' â–¶ï¸ ğŸ§¾ì—…ë¡œë“œ ğŸ‘ˆí´ë¦­* \n 
            âœ… Cart List ë‹¤ìš´ë¡œë“œ í›„ ë³„ë„ì˜ ì”ì—¬ ì»¬ëŸ¼ì„ ì‚­ì œí•˜ì§€ ì•Šìœ¼ì…”ë„ ë©ë‹ˆë‹¤. \n
            âœ… Cart List ë‹¤ìš´ë¡œë“œì‹œ, ì—‘ì…€íŒŒì¼ì—ì„œ ì²« 3í–‰ì´ ê³µë€ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. â€» *Lamp(M) ì—…ë¡œë“œ ì‹œ 4í–‰ë¶€í„° Count ì‹¤ì‹œ* \n
            âœ… ì¶”í›„, ìë™ìœ¼ë¡œ í†µì§€ì— ìˆëŠ” ì„¤ë¹„ Tag ì™€ ì„¤ë¹„ ID ê°€ ì…ë ¥ë˜ë„ë¡ ë°˜ì˜ ê°œì„  ì˜ˆì •ì…ë‹ˆë‹¤.\n
            â€» *í˜„ì¬ëŠ”, í†µì§€ì— ë¬¼ë ¤ìˆëŠ” ë™ì¼í•œ ì„¤ë¹„ ID ì™€ Tag No ë¥¼ ì…ë ¥í•´ì•¼ í•¨.* \n
            """
            )
    st.image(
        "/home/dataiku/workspace/code_studio-versioned/streamlit/docs/exp/cart_guide_2.png",
        use_column_width=True,
        caption='*Lamp (m) - í†µì§€ ì‘ì—…ê³„íšìˆ˜ë¦½ í™”ë©´*'
    )

    st.markdown(
            """
            <íŒŒì¼ ë‚´ë¶€ ìƒì„¸>
            """
            )
    st.image(
        "/home/dataiku/workspace/code_studio-versioned/streamlit/docs/exp/cart_guide_1.png",
        use_column_width=True,
        caption='*Lamp (m) - ì—‘ì…€íŒŒì¼ ì–‘ì‹ ì°¸ê³ *'
    )
